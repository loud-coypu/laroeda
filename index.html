<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Ruota della Fortuna</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 1200px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .game-section {
            margin-bottom: 30px;
        }

        .setup-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .setup-section h2 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: bold;
        }

        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .input-group small {
            display: block;
            color: #666;
            margin-top: 5px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .board-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            position: relative;
        }

        .board-oval {
            border: 8px solid #ffd700;
            border-radius: 50%;
            padding: 40px 60px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .board {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .board-row {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .letter-cell {
            width: 45px;
            height: 55px;
            border: 3px solid #ffd700;
            background: white;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            color: transparent;
            transition: all 0.3s ease;
            position: relative;
        }

        .letter-cell.space {
            border: none;
            background: transparent;
        }

        .letter-cell.revealed {
            color: #0066ff;
            animation: reveal 0.5s ease;
        }

        @keyframes reveal {
            0% {
                transform: rotateY(90deg);
                opacity: 0;
            }
            100% {
                transform: rotateY(0deg);
                opacity: 1;
            }
        }

        .info-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .info-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ddd;
        }

        .info-box h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .title-display {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            text-align: center;
        }

        .letters-tried {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .letter-badge {
            padding: 8px 12px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 1em;
            transition: transform 0.2s;
        }

        .letter-badge:hover {
            transform: scale(1.1);
        }

        .letter-badge.correct {
            background: #28a745;
            color: white;
        }

        .letter-badge.incorrect {
            background: #dc3545;
            color: white;
        }

        .guess-section {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .guess-section input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            text-transform: uppercase;
        }

        .guess-section input:focus {
            outline: none;
            border-color: #667eea;
        }

        .message {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            font-weight: bold;
            font-size: 1.2em;
            display: none;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
            display: block;
        }

        .message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #bee5eb;
            display: block;
        }

        .hidden {
            display: none;
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.8em;
            }

            .board-oval {
                padding: 20px 30px;
            }

            .letter-cell {
                width: 35px;
                height: 45px;
                font-size: 1.2em;
            }

            .info-section {
                grid-template-columns: 1fr;
            }

            .board-row {
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¡ La Ruota della Fortuna ðŸŽ¡</h1>

        <!-- Setup Section for Player 1 -->
        <div class="setup-section" id="setupSection">
            <h2>ðŸ‘¤ Giocatore 1 - Sfidante</h2>
            <div class="input-group">
                <label for="titleInput">Titolo (categoria):</label>
                <input type="text" id="titleInput" maxlength="25" placeholder="Es: FILM FAMOSO">
                <small>Massimo 25 caratteri</small>
            </div>
            <div class="input-group">
                <label for="phraseInput">Frase da indovinare:</label>
                <input type="text" id="phraseInput" maxlength="50" placeholder="Es: IL SIGNORE DEGLI ANELLI">
                <small>Massimo 50 caratteri, parole di massimo 14 lettere</small>
            </div>
            <button onclick="setupPhrase()">Imposta Frase</button>
        </div>

        <!-- Game Board -->
        <div class="board-container hidden" id="boardContainer">
            <div class="board-oval">
                <div class="board" id="gameBoard"></div>
            </div>
        </div>

        <!-- Info and Guess Section -->
        <div class="info-section hidden" id="infoSection">
            <div class="info-box">
                <h3>ðŸ“‹ Categoria</h3>
                <div class="title-display" id="titleDisplay">-</div>
                
                <h3>ðŸ”¤ Lettere Provate</h3>
                <div class="letters-tried" id="lettersTried">
                    <em style="color: #999;">Nessuna lettera ancora...</em>
                </div>
            </div>

            <div class="info-box">
                <h3>ðŸŽ¯ Giocatore 2 - Concorrente</h3>
                <div class="guess-section">
                    <input type="text" id="guessInput" placeholder="Inserisci lettera/e" maxlength="10">
                    <button onclick="guessLetter()">Scopri Lettera</button>
                </div>
            </div>
        </div>

        <!-- Message Display -->
        <div class="message" id="messageDisplay"></div>

        <!-- New Game Button -->
        <div class="button-group hidden" id="newGameButton">
            <button onclick="newGame()">ðŸ”„ Nuova Partita</button>
        </div>
    </div>

    <script>
        let gameState = {
            title: '',
            phrase: '',
            normalizedPhrase: '',
            revealedLetters: new Set(),
            triedLetters: new Set(),
            correctLetters: new Set(),
            incorrectLetters: new Set(),
            gameStarted: false,
            gameWon: false
        };

        const rowSizes = [12, 14, 14, 12];

        function normalizeText(text) {
            // Normalize text but keep original for display
            return text.toUpperCase();
        }

        function removeAccents(text) {
            // Map for checking letter matches (removes accents)
            const accentMap = {
                'Ã€': 'A', 'Ãˆ': 'E', 'Ã‰': 'E', 'ÃŒ': 'I', 'Ã’': 'O', 'Ã™': 'U',
                'Ã ': 'A', 'Ã¨': 'E', 'Ã©': 'E', 'Ã¬': 'I', 'Ã²': 'O', 'Ã¹': 'U'
            };
            return text.toUpperCase().split('').map(char => accentMap[char] || char).join('');
        }

        function setupPhrase() {
            const title = document.getElementById('titleInput').value.trim();
            const phrase = document.getElementById('phraseInput').value.trim();

            if (!title || !phrase) {
                showMessage('Per favore inserisci sia il titolo che la frase!', 'info');
                return;
            }

            // Validate phrase length
            const words = phrase.split(' ');
            const tooLongWords = words.filter(word => word.length > 14);
            if (tooLongWords.length > 0) {
                showMessage('Alcune parole superano i 14 caratteri!', 'info');
                return;
            }

            if (phrase.length > 50) {
                showMessage('La frase supera i 50 caratteri!', 'info');
                return;
            }

            gameState.title = normalizeText(title);
            gameState.phrase = normalizeText(phrase);
            gameState.normalizedPhrase = removeAccents(phrase);
            gameState.revealedLetters = new Set();
            gameState.triedLetters = new Set();
            gameState.correctLetters = new Set();
            gameState.incorrectLetters = new Set();
            gameState.gameStarted = true;
            gameState.gameWon = false;

            // Hide setup, show game
            document.getElementById('setupSection').classList.add('hidden');
            document.getElementById('boardContainer').classList.remove('hidden');
            document.getElementById('infoSection').classList.remove('hidden');
            document.getElementById('newGameButton').classList.remove('hidden');

            // Display title
            document.getElementById('titleDisplay').textContent = gameState.title;

            // Create board
            createBoard();

            // Focus on guess input
            document.getElementById('guessInput').focus();

            showMessage('Partita iniziata! Indovina le lettere!', 'info');
        }

        function createBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';

            const words = gameState.phrase.split(' ');
            let currentRow = 0;
            let currentCol = 0;
            let rows = [[], [], [], []];

            // Distribute words across rows
            for (let word of words) {
                // Check if word fits in current row
                if (currentCol + word.length > rowSizes[currentRow]) {
                    currentRow++;
                    currentCol = 0;
                    if (currentRow >= 4) {
                        showMessage('La frase Ã¨ troppo lunga per il tabellone!', 'info');
                        return;
                    }
                }

                // Add word to row
                for (let char of word) {
                    rows[currentRow].push(char);
                    currentCol++;
                }

                // Add space after word (if not at end of row)
                if (currentCol < rowSizes[currentRow]) {
                    rows[currentRow].push(' ');
                    currentCol++;
                }
            }

            // Create visual rows
            for (let i = 0; i < 4; i++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'board-row';

                const rowSize = rowSizes[i];
                const rowData = rows[i];
                
                // Calculate padding for centering
                const totalChars = rowData.length;
                const leftPadding = Math.floor((rowSize - totalChars) / 2);
                const rightPadding = rowSize - totalChars - leftPadding;

                // Add left padding
                for (let j = 0; j < leftPadding; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'letter-cell space';
                    rowDiv.appendChild(cell);
                }

                // Add actual characters
                for (let j = 0; j < rowData.length; j++) {
                    const char = rowData[j];
                    const cell = document.createElement('div');
                    cell.className = 'letter-cell';
                    cell.dataset.row = i;
                    cell.dataset.col = leftPadding + j;

                    if (char === ' ') {
                        cell.className = 'letter-cell space';
                    } else {
                        cell.dataset.letter = char;
                        cell.dataset.normalized = removeAccents(char);
                        cell.textContent = char;
                    }

                    rowDiv.appendChild(cell);
                }

                // Add right padding
                for (let j = 0; j < rightPadding; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'letter-cell space';
                    rowDiv.appendChild(cell);
                }

                board.appendChild(rowDiv);
            }
        }

        function guessLetter() {
            if (!gameState.gameStarted || gameState.gameWon) return;

            const input = document.getElementById('guessInput');
            const guesses = input.value.trim().toUpperCase();
            input.value = '';

            if (!guesses) {
                showMessage('Per favore inserisci almeno una lettera!', 'info');
                return;
            }

            let foundAny = false;

            // Process each letter
            for (let guess of guesses) {
                // Skip if already tried
                if (gameState.triedLetters.has(guess)) {
                    continue;
                }

                // Normalize the guess for comparison
                const normalizedGuess = removeAccents(guess);

                gameState.triedLetters.add(guess);

                // Check if letter exists in phrase
                const cells = document.querySelectorAll('.letter-cell[data-normalized]');
                let found = false;

                cells.forEach(cell => {
                    if (cell.dataset.normalized === normalizedGuess) {
                        cell.classList.add('revealed');
                        gameState.revealedLetters.add(cell.dataset.letter);
                        found = true;
                        foundAny = true;
                    }
                });

                if (found) {
                    gameState.correctLetters.add(guess);
                } else {
                    gameState.incorrectLetters.add(guess);
                }
            }

            updateLettersTried();

            // Check if game is won
            checkWin();

            if (foundAny && !gameState.gameWon) {
                showMessage('Bravo! Hai trovato delle lettere!', 'success');
            } else if (!gameState.gameWon) {
                showMessage('Nessuna lettera trovata. Riprova!', 'info');
            }

            document.getElementById('guessInput').focus();
        }

        function updateLettersTried() {
            const container = document.getElementById('lettersTried');
            container.innerHTML = '';

            const allLetters = Array.from(gameState.triedLetters).sort();

            if (allLetters.length === 0) {
                container.innerHTML = '<em style="color: #999;">Nessuna lettera ancora...</em>';
                return;
            }

            allLetters.forEach(letter => {
                const badge = document.createElement('span');
                badge.className = 'letter-badge';
                badge.textContent = letter;

                if (gameState.correctLetters.has(letter)) {
                    badge.classList.add('correct');
                } else {
                    badge.classList.add('incorrect');
                }

                container.appendChild(badge);
            });
        }

        function checkWin() {
            const cells = document.querySelectorAll('.letter-cell[data-letter]');
            const allRevealed = Array.from(cells).every(cell => cell.classList.contains('revealed'));

            if (allRevealed) {
                gameState.gameWon = true;
                showMessage('ðŸŽ‰ Complimenti! Hai vinto! Hai indovinato la frase! ðŸŽ‰', 'success');
                document.getElementById('guessInput').disabled = true;
            }
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('messageDisplay');
            messageDiv.textContent = text;
            messageDiv.className = 'message ' + type;
            
            setTimeout(() => {
                if (!gameState.gameWon) {
                    messageDiv.style.display = 'none';
                }
            }, 3000);
        }

        function newGame() {
            // Reset game state
            gameState = {
                title: '',
                phrase: '',
                normalizedPhrase: '',
                revealedLetters: new Set(),
                triedLetters: new Set(),
                correctLetters: new Set(),
                incorrectLetters: new Set(),
                gameStarted: false,
                gameWon: false
            };

            // Reset UI
            document.getElementById('titleInput').value = '';
            document.getElementById('phraseInput').value = '';
            document.getElementById('guessInput').value = '';
            document.getElementById('guessInput').disabled = false;
            document.getElementById('messageDisplay').style.display = 'none';

            document.getElementById('setupSection').classList.remove('hidden');
            document.getElementById('boardContainer').classList.add('hidden');
            document.getElementById('infoSection').classList.add('hidden');
            document.getElementById('newGameButton').classList.add('hidden');

            document.getElementById('titleInput').focus();
        }

        // Allow Enter key to submit
        document.getElementById('guessInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                guessLetter();
            }
        });

        document.getElementById('titleInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                document.getElementById('phraseInput').focus();
            }
        });

        document.getElementById('phraseInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                setupPhrase();
            }
        });
    </script>
</body>
</html>